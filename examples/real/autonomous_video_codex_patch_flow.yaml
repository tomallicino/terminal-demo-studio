title: "Autonomous Video Real Codex Patch Flow"
output: "autonomous_video_real_codex_patch_flow"
settings:
  width: 1440
  height: 900
  theme: "GruvboxDark"
  framerate: 30
scenarios:
  - label: "Real Codex Patch Flow"
    execution_mode: "autonomous_video"
    setup:
      - "if [ -n \"${OPENAI_API_KEY:-}\" ]; then printf \"%s\" \"$OPENAI_API_KEY\" | codex login --with-api-key >/dev/null 2>&1 || true; fi"
      - "mkdir -p /workspace/examples/real/codex_demo_workspace"
      - "printf '%s\n' 'TODO: replace this marker with DONE' > /workspace/examples/real/codex_demo_workspace/task.txt"
    actions:
      - command: "codex -a never -s workspace-write"
      - sleep: "2s"
      - input: "Run these exact shell commands in order, then reply with token TDS_PATCH_APPLIED: 1) perl -0pi -e 's/TODO:/DONE:/' /workspace/examples/real/codex_demo_workspace/task.txt 2) cat /workspace/examples/real/codex_demo_workspace/task.txt"
      - key: "enter"
      - wait_for: "TDS_PATCH_APPLIED"
        wait_mode: "screen"
        wait_timeout: "240s"
      - sleep: "1s"
  - label: "Patch Verification"
    execution_mode: "autonomous_video"
    actions:
      - command: "cat /workspace/examples/real/codex_demo_workspace/task.txt"
      - wait_for: "DONE: replace this marker with DONE"
        wait_mode: "line"
        wait_timeout: "30s"
      - command: "printf '%s\\n' 'TDS_FILE_VERIFIED'"
      - wait_for: "TDS_FILE_VERIFIED"
        wait_mode: "screen"
        wait_timeout: "30s"
      - sleep: "1s"
