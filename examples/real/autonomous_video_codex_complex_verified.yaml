title: "Autonomous Video Real Codex Complex Verified"
output: "autonomous_video_real_codex_complex_verified"
settings:
  width: 1440
  height: 900
  theme: "GruvboxDark"
  framerate: 30
scenarios:
  - label: "Real Codex Complex Workflow"
    execution_mode: "autonomous_video"
    setup:
      - "if [ -n \"${OPENAI_API_KEY:-}\" ]; then printf \"%s\" \"$OPENAI_API_KEY\" | codex login --with-api-key >/dev/null 2>&1 || true; fi"
      - "mkdir -p /workspace/examples/real/codex_demo_workspace"
      - "rm -f /workspace/examples/real/codex_demo_workspace/complex_workflow.txt"
    actions:
      - command: "codex -a never -s workspace-write"
      - sleep: "2s"
      - input: "Reply with only the reverse of the word stressed."
      - key: "enter"
      - wait_for: "desserts"
        wait_mode: "line"
        wait_timeout: "120s"
      - input: "!python3 -c \"import hashlib; from pathlib import Path; p=Path('/workspace/examples/real/codex_demo_workspace/complex_workflow.txt'); p.parent.mkdir(parents=True, exist_ok=True); p.write_text('safe_complex_workflow_ok'+chr(10), encoding='utf-8'); print(hashlib.sha256(b'tds-write-ok').hexdigest())\""
      - key: "enter"
      - wait_for: "90f7d2b644ccaa40a03b7ad262492f80695cfc609c760cdb8b2554c3830561ed"
        wait_mode: "line"
        wait_timeout: "120s"
      - sleep: "1s"
  - label: "Independent Verification"
    execution_mode: "autonomous_video"
    actions:
      - command: "python3 -c \"from pathlib import Path; value=Path('/workspace/examples/real/codex_demo_workspace/complex_workflow.txt').read_text(encoding='utf-8').strip(); print(value); print('TDS_VERIFY_DONE')\""
      - wait_for: "^safe_complex_workflow_ok$"
        wait_mode: "line"
        wait_timeout: "30s"
      - wait_for: "^TDS_VERIFY_DONE$"
        wait_mode: "line"
        wait_timeout: "30s"
      - sleep: "1s"
